<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>微信小程序入门教程 | WePY</title>
    <meta name="description" content="一份伪官方文档">
    
    
    <link rel="preload" href="/assets/css/14.styles.ba993ac0.css" as="style"><link rel="preload" href="/assets/js/app.a6fe7f3d.js" as="script"><link rel="preload" href="/assets/js/0.d7267350.js" as="script"><link rel="prefetch" href="/assets/js/1.f6a68714.js"><link rel="prefetch" href="/assets/js/2.b22d20dc.js"><link rel="prefetch" href="/assets/js/3.85029a80.js"><link rel="prefetch" href="/assets/js/4.64ad024a.js"><link rel="prefetch" href="/assets/js/5.80474e28.js"><link rel="prefetch" href="/assets/js/6.14e78792.js"><link rel="prefetch" href="/assets/js/7.de40f043.js"><link rel="prefetch" href="/assets/js/8.df65b4bd.js"><link rel="prefetch" href="/assets/js/9.426e9edf.js"><link rel="prefetch" href="/assets/js/10.f793a7cd.js"><link rel="prefetch" href="/assets/js/11.693f8ff9.js"><link rel="prefetch" href="/assets/js/12.48dff462.js"><link rel="prefetch" href="/assets/js/13.3c071d67.js">
    <link rel="stylesheet" href="/assets/css/14.styles.ba993ac0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      微信小程序入门教程
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link">基础</a></div><div class="nav-item"><a href="/wepy/" class="nav-link router-link-exact-active router-link-active">Wepy</a></div><a href="https://github.com/lipengzhou/miniprogram-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link">基础</a></div><div class="nav-item"><a href="/wepy/" class="nav-link router-link-exact-active router-link-active">Wepy</a></div><a href="https://github.com/lipengzhou/miniprogram-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>WePY</span><!----></p><ul class="sidebar-group-items"><li><a href="/wepy/#介绍" class="sidebar-link">介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wepy/#是什么" class="sidebar-link">是什么</a></li><li class="sidebar-sub-header"><a href="/wepy/#特性" class="sidebar-link">特性</a></li><li class="sidebar-sub-header"><a href="/wepy/#相关链接" class="sidebar-link">相关链接</a></li></ul></li><li><a href="/wepy/#快速入门" class="sidebar-link">快速入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wepy/#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/wepy/#初始化" class="sidebar-link">初始化</a></li><li class="sidebar-sub-header"><a href="/wepy/#编译构建" class="sidebar-link">编译构建</a></li><li class="sidebar-sub-header"><a href="/wepy/#项目目录结构" class="sidebar-link">项目目录结构</a></li><li class="sidebar-sub-header"><a href="/wepy/#添加项目" class="sidebar-link">添加项目</a></li><li class="sidebar-sub-header"><a href="/wepy/#参考建议" class="sidebar-link">参考建议</a></li><li class="sidebar-sub-header"><a href="/wepy/#代码高亮" class="sidebar-link">代码高亮</a></li><li class="sidebar-sub-header"><a href="/wepy/#代码编写规则" class="sidebar-link">代码编写规则</a></li></ul></li><li><a href="/wepy/#主要功能特性" class="sidebar-link">主要功能特性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wepy/#开发模式转换" class="sidebar-link">开发模式转换</a></li><li class="sidebar-sub-header"><a href="/wepy/#支持组件化开发" class="sidebar-link">支持组件化开发</a></li><li class="sidebar-sub-header"><a href="/wepy/#支持加载外部npm包" class="sidebar-link">支持加载外部NPM包</a></li><li class="sidebar-sub-header"><a href="/wepy/#单文件模式，目录结构更清晰，开发更方便" class="sidebar-link">单文件模式，目录结构更清晰，开发更方便</a></li><li class="sidebar-sub-header"><a href="/wepy/#默认使用babel编译，支持es6-7的一些新特性" class="sidebar-link">默认使用babel编译，支持ES6/7的一些新特性</a></li><li class="sidebar-sub-header"><a href="/wepy/#针对原生api进行优化" class="sidebar-link">针对原生API进行优化</a></li></ul></li><li><a href="/wepy/#wepy中的数据绑定" class="sidebar-link">WePY中的数据绑定</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wepy/#原生小程序的数据绑定方式" class="sidebar-link">原生小程序的数据绑定方式</a></li><li class="sidebar-sub-header"><a href="/wepy/#wepy数据绑定方式" class="sidebar-link">WePY数据绑定方式</a></li></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="wepy"><a href="#wepy" aria-hidden="true" class="header-anchor">#</a> WePY</h1><h2 id="介绍"><a href="#介绍" aria-hidden="true" class="header-anchor">#</a> 介绍</h2><h3 id="是什么"><a href="#是什么" aria-hidden="true" class="header-anchor">#</a> 是什么</h3><p>WePY (发音: /'wepi/)是一款让小程序支持组件化开发的框架，通过预编译的手段让开发者可以选择自己喜欢的开发风格去开发小程序。框架的细节优化，Promise，Async Functions的引入都是为了能让开发小程序项目变得更加简单，高效。</p><p>同时WePY也是一款成长中的框架，大量吸收借鉴了一些优化前端工具以及框架的设计理念和思想。如果WePY有不足地方，或者你有更好的想法，欢迎提交ISSUE或者PR。</p><h3 id="特性"><a href="#特性" aria-hidden="true" class="header-anchor">#</a> 特性</h3><ul><li>类Vue开发风格</li><li>支持自定义组件开发</li><li>支持引入NPM包</li><li>支持Promise</li><li>支持ES2015+特性，如Async Functions</li><li>支持多种编译器，Less/Sass/Stylus/PostCSS、Babel/Typescript、Pug</li><li>支持多种插件处理，文件压缩，图片压缩，内容替换等</li><li>支持 Sourcemap，ESLint等</li><li>小程序细节优化，如请求列队，事件优化等</li></ul><h3 id="相关链接"><a href="#相关链接" aria-hidden="true" class="header-anchor">#</a> 相关链接</h3><ul><li><a href="https://tencent.github.io/wepy/" target="_blank" rel="noopener noreferrer">Wepy 官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://github.com/Tencent/wepy" target="_blank" rel="noopener noreferrer">Wepy GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h2 id="快速入门"><a href="#快速入门" aria-hidden="true" class="header-anchor">#</a> 快速入门</h2><h3 id="安装"><a href="#安装" aria-hidden="true" class="header-anchor">#</a> 安装</h3><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 全局安装 Wepy 命令行工具</span>
<span class="token function">npm</span> i -g wepy-cli

<span class="token comment"># 查看安装的 Wepy 确实 Wepy 是否安装好</span>
wepy --version
</code></pre></div><h3 id="初始化"><a href="#初始化" aria-hidden="true" class="header-anchor">#</a> 初始化</h3><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 查看可用模板</span>
wepy list
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 使用 Wepy 基于 standard 模板初始化项目</span>
wepy init standard wepy-demo
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 安装依赖</span>
<span class="token function">cd</span> wepy-demo
<span class="token function">npm</span> <span class="token function">install</span>
</code></pre></div><h3 id="编译构建"><a href="#编译构建" aria-hidden="true" class="header-anchor">#</a> 编译构建</h3><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 执行打包</span>
<span class="token comment"># wepy 会把 src 中的源码编程成小程序代码文件，输出到 dist 目录中</span>
wepy build

<span class="token comment"># 监视打包</span>
<span class="token comment"># 建议在开发的时候使用监视代码，Wepy 会监视 src 源码的改变，然后实时的编译打包</span>
wepy build -w
</code></pre></div><h3 id="项目目录结构"><a href="#项目目录结构" aria-hidden="true" class="header-anchor">#</a> 项目目录结构</h3><div class="language- extra-class"><pre class="language-text"><code>├── dist                   小程序运行代码目录（该目录由WePY的build指令自动编译生成，请不要直接修改该目录下的文件）
├── node_modules           
├── src                    代码编写的目录（该目录为使用WePY后的开发目录）
|   ├── components         WePY组件目录（组件不属于完整页面，仅供完整页面或其他组件引用）
|   |   ├── com_a.wpy      可复用的WePY组件a
|   |   └── com_b.wpy      可复用的WePY组件b
|   ├── pages              WePY页面目录（属于完整页面）
|   |   ├── index.wpy      index页面（经build后，会在dist目录下的pages目录生成index.js、index.json、index.wxml和index.wxss文件）
|   |   └── other.wpy      other页面（经build后，会在dist目录下的pages目录生成other.js、other.json、other.wxml和other.wxss文件）
|   └── app.wpy            小程序配置项（全局数据、样式、声明钩子等；经build后，会在dist目录下生成app.js、app.json和app.wxss文件）
└── package.json           项目的package配置
</code></pre></div><h4 id="app-wpy"><a href="#app-wpy" aria-hidden="true" class="header-anchor">#</a> app.wpy</h4><p><img src="/assets/img/1527737843592.cc1cae02.png" alt="1527737843592"></p><h4 id="页面-wpy"><a href="#页面-wpy" aria-hidden="true" class="header-anchor">#</a> 页面.wpy</h4><p><img src="/assets/img/1527739143610.97a36129.png" alt="1527739143610"></p><h3 id="添加项目"><a href="#添加项目" aria-hidden="true" class="header-anchor">#</a> 添加项目</h3><p><code>1.7.0</code> 之后的版本<code>init</code>新生成的代码包会在根目录包含<code>project.config.json</code>文件，之前生成的代码包可能不存在<code>project.config.json</code>文件。 检查根目录是否存在该文件。</p><p>如果存在，使用<code>微信开发者工具</code>--&gt;<code>添加项目</code>，<code>项目目录</code>请选择项目根目录即可根据配置完成项目信息自动配置。</p><p>如果不存在，建议手动创建该文件后再添加项目。<code>project.config.json</code>文件内容如下：</p><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;project description&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;setting&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;urlCheck&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;es6&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;postcss&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;minified&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;compileType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;miniprogram&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;appid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;touristappid&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;projectname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Project name&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;miniprogramRoot&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./dist&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>es6</code>: 对应<code>关闭ES6转ES5</code>选项，关闭。 重要：未关闭会运行报错。</p><p><code>postcss</code>: 对应<code>关闭上传代码时样式自动补全</code>选项，关闭。 重要：某些情况下漏掉此项也会运行报错。</p><p><code>minified</code>: 对应<code>关闭代码压缩上传</code>选项，关闭。重要：开启后，会导致真机computed, props.sync 等等属性失效。（注：压缩功能可使用WePY提供的build指令代替，详见后文相关介绍以及Demo项目根目录中的<code>wepy.config.js</code>和<code>package.json</code>文件。）</p><p><code>urlCheck</code>: 对应<code>不检查安全域名</code>选项，开启。 如果已配置好安全域名则建议关闭。</p><h3 id="参考建议"><a href="#参考建议" aria-hidden="true" class="header-anchor">#</a> 参考建议</h3><ol><li><p>WePY借鉴了Vue.js（后文简称Vue）的语法风格和功能特性，如果你之前从未接触过Vue，建议先阅读Vue的官方文档，以熟悉相关概念，否则在阅读WePY文档以及使用WePY进行开发的过程中，将会遇到比较多的障碍。</p></li><li><p>开发建议使用第三方成熟IDE或编辑器(具体请参看后文的代码高亮部分)，微信开发者工具仅用于实时预览和调试。</p></li></ol><h3 id="代码高亮"><a href="#代码高亮" aria-hidden="true" class="header-anchor">#</a> 代码高亮</h3><p>文件后缀为<code>.wpy</code>，可共用<code>Vue</code>的高亮规则，但需要手动设置。下面提供一些常见IDE或编辑器中实现代码高亮的相关设置步骤以供参考(也可通过更改文件后缀名的方式来实现高亮，详见后文相关介绍)。</p><ul><li><strong>Sublime</strong></li></ul><p>1. 打开<code>Sublime-&gt;Preferences-&gt;Browse Packages..</code>进入用户包文件夹。</p><p>2. 在此文件夹下打开cmd，运行<code>git clone git@github.com:vuejs/vue-syntax-highlight.git</code>，无GIT用户可以直接下载<a href="https://github.com/vuejs/vue-syntax-highlight/archive/master.zip" target="_blank" rel="noopener noreferrer">zip包<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>解压至当前文件夹。</p><p>3. 关闭<code>.wpy</code>文件重新打开即可高亮。</p><ul><li><strong>WebStorm/PhpStorm</strong></li></ul><p>1. 打开<code>Settings</code>，搜索<code>Plugins</code>，搜索<code>Vue.js</code>插件并安装。</p><p>2. 打开<code>Settings</code>，搜索<code>File Types</code>，找到<code>Vue.js Template</code>，在<code>Registered Patterns</code>添加<code>*.wpy</code>，即可高亮。</p><ul><li><strong>Atom</strong></li></ul><p>1. 在Atom里先安装Vue的语法高亮 - <code>language-vue</code>，如果装过了就忽略这一步。</p><p>2. 打开<code>Atom -&gt; Config</code>菜单。在<code>core</code>键下添加：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>customFileTypes<span class="token punctuation">:</span>
   <span class="token string">&quot;text.html.vue&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;wpy&quot;</span>
   <span class="token punctuation">]</span>
</code></pre></div><ul><li><strong>VS Code</strong></li></ul><p>1. 在 Code 里先安装 Vue 的语法高亮插件 <code>Vetur</code>。</p><p>2. 打开任意 <code>.wpy</code> 文件。</p><p>3. 点击右下角的选择语言模式，默认为<code>纯文本</code>。</p><p>4. 在弹出的窗口中选择 <code>.wpy 的配置文件关联...</code>。</p><p>5. 在<code>选择要与 .wpy 关联的语言模式</code> 中选择 <code>Vue</code>。</p><ul><li><strong>VIM</strong></li></ul><p>1. 安装 <code>Vue</code> 的 VIM 高亮插件，例如 <a href="https://github.com/posva/vim-vue" target="_blank" rel="noopener noreferrer">posva/vim-vue<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p><p>2. 配置 <code>.wpy</code> 后缀名的文件使用 <code>Vue</code> 语法高亮。</p><div class="language- extra-class"><pre class="language-text"><code> au BufRead,BufNewFile *.wpy setlocal filetype=vue.html.javascript.css
</code></pre></div><h3 id="代码编写规则"><a href="#代码编写规则" aria-hidden="true" class="header-anchor">#</a> 代码编写规则</h3><ol><li>变量与方法尽量使用驼峰式命名，并且注意避免使用<code>$</code>开头。 以<code>$</code>开头的标识符为WePY框架的内建属性和方法，可在JavaScript脚本中以<code>this.</code>的方式直接使用，具体请<a href="https://tencent.github.io/wepy/document.html#/api?id=api" target="_blank" rel="noopener noreferrer">参考API文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</li><li>小程序入口、页面、组件文件名的后缀为<code>.wpy</code>；外链的文件可以是其它后缀。 具体请参考<a href="https://tencent.github.io/wepy/document.html#/?id=wpy%e6%96%87%e4%bb%b6%e8%af%b4%e6%98%8e" target="_blank" rel="noopener noreferrer">wpy文件说明<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</li><li>使用ES6语法开发。 框架在ES6(ECMAScript 6)下开发，因此也需要使用ES6开发小程序，ES6中有大量的语法糖可以让我们的代码更加简洁高效。</li><li>使用Promise。 框架默认对小程序提供的API全都进行了 Promise 处理，甚至可以直接使用<code>async/await</code>等新特性进行开发。<a href="https://github.com/Tencent/wepy/wiki/wepy%E9%A1%B9%E7%9B%AE%E4%B8%AD%E4%BD%BF%E7%94%A8Promise" target="_blank" rel="noopener noreferrer">启用Promise方法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>事件绑定语法使用优化语法代替。
<ul><li>原 <code>bindtap=&quot;click&quot;</code> 替换为 <code>@tap=&quot;click&quot;</code>，原<code>catchtap=&quot;click&quot;</code>替换为<code>@tap.stop=&quot;click&quot;</code>。</li><li>原 <code>capture-bind:tap=&quot;click&quot;</code> 替换为 <code>@tap.capture=&quot;click&quot;</code>，原<code>capture-catch:tap=&quot;click&quot;</code>替换为<code>@tap.capture.stop=&quot;click&quot;</code>。</li><li>更多<code>@</code>符用法，参见<a href="https://tencent.github.io/wepy/document.html#/?id=%E7%BB%84%E4%BB%B6%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0" target="_blank" rel="noopener noreferrer">组件自定义事件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</li></ul></li><li>事件传参使用优化后语法代替。 原<code>bindtap=&quot;click&quot; data-index=</code>替换为<code>@tap=&quot;click()&quot;</code>。</li><li>自定义组件命名应避开微信原生组件名称以及功能标签<code>&lt;repeat&gt;</code>。 不可以使用<code>input、button、view、repeat</code>等微信小程序原生组件名称命名自定义组件；另外也不要使用WePY框架定义的辅助标签<code>repeat</code>命名。有关<code>repeat</code>的详细信息，请参见<a href="https://tencent.github.io/wepy/document.html#/?id=%E7%BB%84%E4%BB%B6%E7%9A%84%E5%BE%AA%E7%8E%AF%E6%B8%B2%E6%9F%93" target="_blank" rel="noopener noreferrer">循环列表组件引用<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</li></ol><h2 id="主要功能特性"><a href="#主要功能特性" aria-hidden="true" class="header-anchor">#</a> 主要功能特性</h2><h3 id="开发模式转换"><a href="#开发模式转换" aria-hidden="true" class="header-anchor">#</a> 开发模式转换</h3><p>WePY框架在开发过程中参考了Vue等现有框架的一些语法风格和功能特性，对原生小程序的开发模式进行了再次封装，更贴近于MVVM架构模式。以下是使用WePY前后的代码对比。</p><p>原生代码：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//index.js</span>

<span class="token comment">//获取应用实例</span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//通过Page构造函数创建页面逻辑</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">//可用于页面模板绑定的数据</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        motto<span class="token punctuation">:</span> <span class="token string">'Hello World'</span><span class="token punctuation">,</span>
        userInfo<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">//事件处理函数</span>
    bindViewTap<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'button clicked'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">//页面的生命周期函数</span>
    onLoad<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onLoad'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>基于WePY的代码：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//index.wpy中的&lt;script&gt;部分</span>

<span class="token keyword">import</span> wepy <span class="token keyword">from</span> <span class="token string">'wepy'</span><span class="token punctuation">;</span>

<span class="token comment">//通过继承自wepy.page的类创建页面逻辑</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">wepy<span class="token punctuation">.</span>page</span> <span class="token punctuation">{</span>
    <span class="token comment">//可用于页面模板绑定的数据</span>
    data <span class="token operator">=</span> <span class="token punctuation">{</span>
        motto<span class="token punctuation">:</span> <span class="token string">'Hello World'</span><span class="token punctuation">,</span>
        userInfo<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">//事件处理函数(集中保存在methods对象中)</span>
    methods <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function">bindViewTap</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'button clicked'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">//页面的生命周期函数</span>
    <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onLoad'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="支持组件化开发"><a href="#支持组件化开发" aria-hidden="true" class="header-anchor">#</a> 支持组件化开发</h3><p>参见章节：<a href="https://tencent.github.io/wepy/document.html#/?id=%e7%bb%84%e4%bb%b6" target="_blank" rel="noopener noreferrer">组件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>示例代码：</p><div class="language-vue extra-class"><pre class="language-vue"><code>// index.wpy

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>panel</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>panel</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>counter1</span> <span class="token attr-name">:num</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>myNum<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>counter1</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>counter2</span> <span class="token attr-name">:num.sync</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>syncNum<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>counter2</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span> <span class="token attr-name">:item</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>items<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">import</span> wepy <span class="token keyword">from</span> <span class="token string">'wepy'</span><span class="token punctuation">;</span>
<span class="token comment">//引入List、Panel和Counter组件</span>
<span class="token keyword">import</span> List <span class="token keyword">from</span> <span class="token string">'../components/list'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Panel <span class="token keyword">from</span> <span class="token string">'../components/panel'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Counter <span class="token keyword">from</span> <span class="token string">'../components/counter'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">wepy<span class="token punctuation">.</span>page</span> <span class="token punctuation">{</span>
    <span class="token comment">//页面配置</span>
    config <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;navigationBarTitleText&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;test&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">//声明页面中将要使用到的组件</span>
    components <span class="token operator">=</span> <span class="token punctuation">{</span>
        panel<span class="token punctuation">:</span> Panel<span class="token punctuation">,</span>
        counter1<span class="token punctuation">:</span> Counter<span class="token punctuation">,</span>
        counter2<span class="token punctuation">:</span> Counter<span class="token punctuation">,</span>
        list<span class="token punctuation">:</span> List
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">//可用于页面模板中绑定的数据</span>
    data <span class="token operator">=</span> <span class="token punctuation">{</span>
        myNum<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
        syncNum<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
        items<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="支持加载外部npm包"><a href="#支持加载外部npm包" aria-hidden="true" class="header-anchor">#</a> 支持加载外部NPM包</h3><p>在编译过程当中，会递归遍历代码中的<code>require</code>然后将对应依赖文件从node_modules当中拷贝出来，并且修改<code>require</code>为相对路径，从而实现对外部NPM包的支持。如下图：</p><p><img src="https://cloud.githubusercontent.com/assets/2182004/20554645/482b0f64-b198-11e6-8d4e-70c92326004f.png" alt="img"></p><h3 id="单文件模式，目录结构更清晰，开发更方便"><a href="#单文件模式，目录结构更清晰，开发更方便" aria-hidden="true" class="header-anchor">#</a> 单文件模式，目录结构更清晰，开发更方便</h3><p>原生小程序要求app实例必须有3个文件：<code>app.js</code>、<code>app.json</code>、<code>app.wxss</code>，而page页面则一般有4个文件：<code>page.js</code>、<code>page.json</code>、<code>page.wxml</code>、<code>page.wxss</code>，并且还要求app实例的3个文件以及page页面的4个文件除后缀名外必须同名，具体可参看<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/structure.html?t=20161107" target="_blank" rel="noopener noreferrer">官方目录结构<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p><p>而在WePY中则使用了单文件模式，将原生小程序app实例的3个文件统一为<code>app.wpy</code>，page页面的4个文件统一为<code>page.wpy</code>。使用WePY开发前后的开发目录结构对比如下：</p><p>原生小程序的目录结构：</p><div class="language- extra-class"><pre class="language-text"><code>project
├── pages
|   ├── index
|   |   ├── index.js    index 页面逻辑
|   |   ├── index.json  index 页面配置
|   |   ├── index.wxml  index 页面结构
|   |   └── index.wxss  index 页面样式
|   └── log
|       ├── log.js      log 页面逻辑
|       ├── log.json    log 页面配置
|       ├── log.wxml    log 页面结构
|       └── log.wxss    log 页面样式
├── app.js              小程序逻辑
├── app.json            小程序公共配置
└── app.wxss            小程序公共样式
</code></pre></div><p>使用WePY框架后的开发目录结构(主要为src目录的结构，dist目录除外)：</p><blockquote><p>注：dist目录为WePY通过build指令生成的目录，除额外增加的npm目录外，其目录结构与原生小程序的目录结构类似。</p></blockquote><div class="language- extra-class"><pre class="language-text"><code>project
└── src
    ├── pages
    |   ├── index.wpy    index 页面逻辑、配置、结构、样式
    |   └── log.wpy      log 页面逻辑、配置、结构、样式
    └──app.wpy           小程序逻辑、公共配置、公共样式
</code></pre></div><h3 id="默认使用babel编译，支持es6-7的一些新特性"><a href="#默认使用babel编译，支持es6-7的一些新特性" aria-hidden="true" class="header-anchor">#</a> 默认使用babel编译，支持ES6/7的一些新特性</h3><p>用户可以通过修改<code>wepy.config.js</code>(老版本使用<code>.wepyrc</code>)配置文件，配置自己熟悉的babel环境进行开发。默认开启使用了一些新的特性如<code>promise</code>、<code>async/await</code>（自WePY 1.4.1开始必须手动开启，原因参见前文<code>代码规范</code>一节中的介绍）等等。</p><p>示例代码：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> wepy <span class="token keyword">from</span> <span class="token string">'wepy'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">wepy<span class="token punctuation">.</span>page</span> <span class="token punctuation">{</span>
    <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>data<span class="token punctuation">:</span> <span class="token number">123</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">async</span> <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="针对原生api进行优化"><a href="#针对原生api进行优化" aria-hidden="true" class="header-anchor">#</a> 针对原生API进行优化</h3><p>对小程序原生API进行promise处理，同时修复了一些原生API的缺陷，比如：wx.request的并发问题等。</p><p>原生代码：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function-variable function">onLoad</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    wx<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        success<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            wx<span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                success<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>userinfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    self<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>userInfo<span class="token punctuation">:</span> userinfo<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>基于WePY的代码：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> wepy <span class="token keyword">from</span> <span class="token string">'wepy'</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> wepy<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userInfo <span class="token operator">=</span> <span class="token keyword">await</span> wepy<span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在同时并发10个request请求测试时：</p><p>不使用WePY:</p><p><img src="https://cloud.githubusercontent.com/assets/2182004/20554651/5185f740-b198-11e6-88f8-45e359090dc3.png" alt="2 small"><img src="https://cloud.githubusercontent.com/assets/2182004/20554886/c30e802a-b199-11e6-927d-08cd4e5ed0b0.png" alt="2 small"></p><p>使用WePY后：</p><p><img src="https://cloud.githubusercontent.com/assets/2182004/20554663/65704c2e-b198-11e6-8277-abb77e0c7b3e.png" alt="img"></p><h2 id="wepy中的数据绑定"><a href="#wepy中的数据绑定" aria-hidden="true" class="header-anchor">#</a> WePY中的数据绑定</h2><h3 id="原生小程序的数据绑定方式"><a href="#原生小程序的数据绑定方式" aria-hidden="true" class="header-anchor">#</a> 原生小程序的数据绑定方式</h3><p>原生小程序通过<code>Page</code>提供的<code>setData</code>方法来绑定数据，如：</p><div class="language- extra-class"><pre class="language-text"><code>this.setData({title: 'this is title'});
</code></pre></div><p>因为小程序架构本身原因，页面渲染层和JS逻辑层分开的，setData操作实际就是JS逻辑层与页面渲染层之间的通信，那么如果在同一次运行周期内多次执行<code>setData</code>操作时，那么通信的次数是一次还是多次呢？这个取决于API本身的设计。</p><h3 id="wepy数据绑定方式"><a href="#wepy数据绑定方式" aria-hidden="true" class="header-anchor">#</a> WePY数据绑定方式</h3><p>WePY使用脏数据检查对setData进行封装，在函数运行周期结束时执行脏数据检查，一来可以不用关心页面多次setData是否会有性能上的问题，二来可以更加简洁去修改数据实现绑定，不用重复去写setData方法。代码如下：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'this is title'</span><span class="token punctuation">;</span>
</code></pre></div><p>需注意的是，在异步函数中更新数据的时候，必须手动调用<code>$apply</code>方法，才会触发脏数据检查流程的运行。如：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'this is title'</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div><div class="content edit-link"><a href="https://github.com/lipengzhou/miniprogram-tutorial/edit/master/docs/wepy/README.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><div class="last-updated"><span class="prefix">上次更新: </span><span class="time">5/31/2018, 5:52:04 AM</span></div></div><!----></div></div></div>
    <script src="/assets/js/0.d7267350.js" defer></script><script src="/assets/js/app.a6fe7f3d.js" defer></script>
  </body>
</html>
